<Schema name="Common Country Programming" metamodelVersion="4.0"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="mondrian.xsd">
    <Annotations>
        <Annotation name="desc">Cube Schema for CCRS - Common Country Programming</Annotation>
    </Annotations>

    <PhysicalSchema>
        <!-- ## _SHARED_PHYSICAL_SCHEMA_TAG_ ## -->
        
        <!-- ## _CATEGORY_QUERIES_TAG_ ## -->
        
        <!-- ## _YESNOTABLE_QUERIES_TAG_ ## -->

        <Query alias="CP3JointProgrammes">
            <ExpressionView>
                <SQL dialect="generic">
                    <![CDATA[
                        select
                            D.ID,
                            D.TITLE,
                            D.TOTAL_BUDGET,
                            COALESCE(D.WHICH_MODALITY_ID, -1) AS WHICH_MODALITY_ID,
                            CP3.DESIGNATION, CP3.ENTITY_YEAR, CP1.COUNTRY_INCOME_STATUS_ID,
                            COALESCE(CP1.SECONDARY_COUNTRY_INCOME_STATUS_ID, -1) AS SECONDARY_COUNTRY_INCOME_STATUS_ID,
                            CASE cp1.OFFICIAL_REQUEST_DAO_COUNTRY WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as OFFICIAL_REQUEST_DAO_COUNTRY
                        FROM CP3JOINT_PROGRAMMES D, CP3COMMON_COUNTRY_PROGRAMMING CP3, CP1GENERAL_PROFILE CP1, BASE_COUNTRY bc, V_CP_VALIDATED_DESIGNATIONS v
                        WHERE
                            CP3.DESIGNATION = CP1.DESIGNATION AND CP3.ENTITY_YEAR = CP1.ENTITY_YEAR AND
                            CP3.ID = D.PARENT_ID AND
                            CP3.DESIGNATION != 'AQ' AND CP3.DESIGNATION != 'DOCO' AND CP3.DESIGNATION = bc.ISO2 AND
                            CP3.DESIGNATION = v.DESIGNATION AND v.ENTITY_YEAR = CP3.ENTITY_YEAR
                            and CP3.HAS_JOINT_PROGRAMMES=true
                    ]]>
                </SQL>
            </ExpressionView>
        </Query>

        <Query alias="CP3GeneralCube">
            <ExpressionView>
                <SQL dialect="generic">
                    <![CDATA[
                        select
                            cp3.ID, cp3.DESIGNATION, cp3.ENTITY_YEAR, CP1.COUNTRY_INCOME_STATUS_ID,
                            COALESCE(CP1.SECONDARY_COUNTRY_INCOME_STATUS_ID, -1) AS SECONDARY_COUNTRY_INCOME_STATUS_ID,
                            COALESCE(cp3.UNDAF_PERIOD_ALIGNED_WITH_GOV_ID, -1) AS UNDAF_PERIOD_ALIGNED_WITH_GOV_ID,
                            CASE WHEN cp3.HASUNDAF = TRUE THEN 1 ELSE 0 END as HASUNDAF_COUNT,
                            CASE cp3.HASUNDAF WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as HASUNDAF,
                            date(cp3undaf.DATE_OF_SIGNATURE) as DATE_OF_SIGNATURE,
                            date(cp3undaf.START_DATE) as START_DATE,
                            date(cp3undaf.END_DATE) as END_DATE,
                            cp3undaf.TOTAL_PLANNED_BUDGET,
                            cp3undaf.PREPARATION_PROCESS_MONTHS,
                            CASE WHEN cp3.IS_DEVELOPING_NEWUNDAF = TRUE THEN 1 ELSE 0 END as IS_DEVELOPING_NEWUNDAF_COUNT,
                            CASE cp3.IS_DEVELOPING_NEWUNDAF WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as IS_DEVELOPING_NEWUNDAF,
                            CASE WHEN cp3.HAS_COMMON_COUNTRY_ASSESSMENT = TRUE THEN 1 ELSE 0 END as HAS_COMMON_COUNTRY_ASSESSMENT_COUNT,
                            CASE cp3.HAS_COMMON_COUNTRY_ASSESSMENT WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as HAS_COMMON_COUNTRY_ASSESSMENT,
                            cp3assessment.ASSESSMENT_YEAR,
                            CASE WHEN cp3.HAS_DISAGGREGATED_DATA = TRUE THEN 1 ELSE 0 END as HAS_DISAGGREGATED_DATA_COUNT,
                            CASE cp3.HAS_DISAGGREGATED_DATA WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as HAS_DISAGGREGATED_DATA,
                            COALESCE(cp3assessment.OTHER_ANALYSIS_SOURCE_ID, -1) AS OTHER_ANALYSIS_SOURCE_ID,
                            CASE WHEN cp3.HAS_NATIONAL_DEVELOPMENT_PLAN = TRUE THEN 1 ELSE 0 END as HAS_NATIONAL_DEVELOPMENT_PLAN_COUNT,
                            CASE cp3.HAS_NATIONAL_DEVELOPMENT_PLAN WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as HAS_NATIONAL_DEVELOPMENT_PLAN,
                            CASE WHEN cp3plan.HASUNSUPPORT = TRUE THEN 1 ELSE 0 END as HASUNSUPPORT_COUNT,
                            CASE cp3plan.HASUNSUPPORT WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as HASUNSUPPORT,
                            CASE WHEN cp3.HAS_JOINT_PROGRAMMES = TRUE THEN 1 ELSE 0 END as HAS_JOINT_PROGRAMMES_COUNT,
                            CASE cp3.HAS_JOINT_PROGRAMMES WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as HAS_JOINT_PROGRAMMES,
                            CASE WHEN cp3.HASUNDAFANNUAL_REVIEW = TRUE THEN 1 ELSE 0 END as HASUNDAFANNUAL_REVIEW_COUNT,
                            CASE cp3.HASUNDAFANNUAL_REVIEW WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as HASUNDAFANNUAL_REVIEW,
                            date(cp3undafannual.DATE_COMPLETED) as HASUNDAFANNUAL_DATE_COMPLETED,
                            CASE WHEN cp3.HASUNDAFEVALUATION = TRUE THEN 1 ELSE 0 END as HASUNDAFEVALUATION_COUNT,
                            CASE cp3.HASUNDAFEVALUATION WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as HASUNDAFEVALUATION,
                            CASE WHEN cp3undafevaluation.MANAGEMENT_RESPONSE_PREPARED = TRUE THEN 1 ELSE 0 END as MANAGEMENT_RESPONSE_PREPARED_COUNT,
                            CASE cp3undafevaluation.MANAGEMENT_RESPONSE_PREPARED WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as MANAGEMENT_RESPONSE_PREPARED,
                            date(cp3undafevaluation.DATE_COMPLETED) as HASUNDAFEVALUATION_DATE_COMPLETED,
                            CASE cp1.OFFICIAL_REQUEST_DAO_COUNTRY WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as OFFICIAL_REQUEST_DAO_COUNTRY,
                            CASE WHEN cp3undaf.UNDAF_EXTENSION_PRESENT = TRUE THEN 1 ELSE 0 END as UNDAF_EXTENSION_PRESENT_COUNT,
                            CASE cp3undaf.UNDAF_EXTENSION_PRESENT WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as UNDAF_EXTENSION_PRESENT,
                            CASE WHEN cp3undaf.THEORY_OF_CHANGE_INCLUDED = TRUE THEN 1 ELSE 0 END as THEORY_OF_CHANGE_INCLUDED_COUNT,
                            CASE cp3undaf.THEORY_OF_CHANGE_INCLUDED WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as THEORY_OF_CHANGE_INCLUDED,
                            CASE WHEN cp3undaf.COSTEDMEPLAN_PRESENT = TRUE THEN 1 ELSE 0 END as COSTEDMEPLAN_PRESENT_COUNT,
                            CASE cp3undaf.COSTEDMEPLAN_PRESENT WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as COSTEDMEPLAN_PRESENT,
                            CASE WHEN cp3undaf.UN_VISION2030PRESENT = TRUE THEN 1 ELSE 0 END as UN_VISION2030PRESENT_COUNT,
                            CASE cp3undaf.UN_VISION2030PRESENT WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as UN_VISION2030PRESENT,
                            CASE WHEN cp3undafunvision2030.NRA_CONTRIBUTOR = TRUE THEN 1 ELSE 0 END as NRA_CONTRIBUTOR_COUNT,
                            CASE cp3undafunvision2030.NRA_CONTRIBUTOR WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as NRA_CONTRIBUTOR,
                            cp3undafcostedmeplan.YEAR_COMPLETED,
                            cp3undafunvision2030.YEAR_PREPARED,
                            COALESCE(cp3undafannual.NRAS_PARTICIPATED_INUNDAFANNUAL_REVIEW_ID, -1) AS NRAS_PARTICIPATED_INUNDAFANNUAL_REVIEW_ID,
                            CASE WHEN cp3newundaf.NEWUNDAFROADMAP_PREPARED = TRUE THEN 1 ELSE 0 END as NEWUNDAFROADMAP_PREPARED_COUNT,
                            CASE cp3newundaf.NEWUNDAFROADMAP_PREPARED WHEN TRUE THEN 1 WHEN FALSE THEN 0 ELSE -1 END as NEWUNDAFROADMAP_PREPARED,
                            date(cp3newundaf.NEWUNDAFROADMAP_DATE) as NEWUNDAFROADMAP_DATE,
                            date(cp3plan.NATIONAL_DEVELOPMENT_PLAN_START_DATE) as NATIONAL_DEVELOPMENT_PLAN_START_DATE,
                            date(cp3plan.NATIONAL_DEVELOPMENT_PLAN_END_DATE) as NATIONAL_DEVELOPMENT_PLAN_END_DATE,
                            COALESCE(cp3plan.SDGS_AND_AGENDA2030IN_NATIONAL_DEVELOPMENT_PLAN_ID, -1) AS SDGS_AND_AGENDA2030IN_NATIONAL_DEVELOPMENT_PLAN_ID,
                            COALESCE(cp3plan.NRAS_PARTICIPATED_IN_NATIONAL_DEVELOPMENT_PLAN_ID, -1) AS NRAS_PARTICIPATED_IN_NATIONAL_DEVELOPMENT_PLAN_ID,
                            COALESCE(cp3undafevaluation.NRA_PARTICIPATED_ID, -1) AS NRA_PARTICIPATED_ID,
                            COALESCE(cp3undafevaluation.NRA_CONTRIBUTE_TO_EVALUATION_MANAGEMENT_RESPONSE_ID, -1) AS NRA_CONTRIBUTE_TO_EVALUATION_MANAGEMENT_RESPONSE_ID
                        from
                            -- DERBY-PROPERTIES joinOrder = FIXED
                            CP3COMMON_COUNTRY_PROGRAMMING cp3, CP1GENERAL_PROFILE cp1,
                            CP3UNDAF cp3undaf, CP3COMMON_COUNTRY_ASSESSMENT cp3assessment, CP3NATIONAL_DEVELOPMENT_PLAN cp3plan,
                            CP3UNDAFEVALUATION cp3undafevaluation, CP3UNDAFANNUAL_REVIEW cp3undafannual,
                            CP3UNDAFUNVISION2030 cp3undafunvision2030, CP3NEWUNDAF cp3newundaf, CP3UNDAFCOSTEDMEPLAN cp3undafcostedmeplan
                        WHERE
                            cp3.DESIGNATION = cp1.DESIGNATION AND cp3.ENTITY_YEAR = cp1.ENTITY_YEAR AND
                            cp3undaf.PARENT_ID = cp3.id AND
                            cp3undafunvision2030.PARENT_ID = cp3undaf.id AND
                            cp3undafcostedmeplan.PARENT_ID = cp3undaf.id AND
                            cp3newundaf.PARENT_ID = cp3.id AND
                            cp3assessment.PARENT_ID = cp3.id AND
                            cp3plan.PARENT_ID = cp3.id AND
                            cp3undafevaluation.PARENT_ID = cp3.id AND
                            cp3undafannual.PARENT_ID = cp3.id AND
                            cp3.DESIGNATION != 'AQ' AND cp3.DESIGNATION != 'DOCO' AND cp3.DESIGNATION in (select iso2 from BASE_COUNTRY) and
                            cp3.designation in (select v.designation from v_cp_validated_designations v where v.entity_year = cp3.ENTITY_YEAR)
                    ]]>
                </SQL>
            </ExpressionView>
        </Query>
    </PhysicalSchema>

    <!--*************************************************************************
    ***** Shared Dimensions
    *************************************************************************-->
    <!-- ## _SHARED_DIMENSIONS_TAG_ ## -->
    
    <!--*************************************************************************
    ***** CP3 Joint Programmes
    *************************************************************************-->
    <Cube name="Joint Programmes" caption="Joint Programmes" visible="true"
          cache="true" enabled="true" defaultMeasure="Count">
        <Dimensions>
            <Dimension source="Region" />
            <Dimension source="Country" />
            <Dimension source="Delivering as One" />
            <Dimension name="Year" caption="Year" table="CP3JointProgrammes" visible="true">
                <Attributes>
                    <Attribute name="Year" keyColumn="ENTITY_YEAR" datatype="Integer" />
                </Attributes>
            </Dimension>
            <Dimension source="CountryIncomeStatus" />
            <Dimension source="SecondaryCountryIncomeStatus" />

            <Dimension name="Title" caption="Title of Joint Programme" table="CP3JointProgrammes"
                       visible="true">
                <Attributes>
                    <Attribute name="Title" caption="Title" keyColumn="TITLE"
                               levelType="Regular" datatype="String" />
                </Attributes>
            </Dimension>
            
            <Dimension source="CATEGORY" table="JointProgrammeModality" caption="Which Funding Modality?" />            
        </Dimensions>

        <MeasureGroups>
            <MeasureGroup name="CP Joint Programmes Measures" table="CP3JointProgrammes">
                <Measures>
                    <Measure name="Count" caption="Number of Joint Programmes" column="ID" datatype="Integer"
                             aggregator="distinct-count" visible="true" formatString="#,###"/>
                    <Measure name="Total Budget" caption="Total Budget (Currency USD)" column="TOTAL_BUDGET"
                             datatype="Numeric" aggregator="sum" visible="true" />
                </Measures>
                <DimensionLinks>
                    <!-- ## _SHARED_DIMENSIONS_LINKS_TAG_ ## -->
                    <FactLink dimension="Title"/>
                    <ForeignKeyLink dimension="JointProgrammeModality" foreignKeyColumn="WHICH_MODALITY_ID" />
                </DimensionLinks>
            </MeasureGroup>
        </MeasureGroups>
    </Cube>

    <!--*************************************************************************
    ***** CP3 General Cube
    *************************************************************************-->
    <Cube name="Common Country Programing" caption="Common Country Programing" visible="true"
          cache="true" enabled="true" defaultMeasure="Count">
        <Dimensions>
            <Dimension source="Region" />
            <Dimension source="Country" />
            <Dimension source="Delivering as One" />
            <Dimension name="Year" caption="Year" table="CP3GeneralCube" visible="true">
                <Attributes>
                    <Attribute name="Year" keyColumn="ENTITY_YEAR" datatype="Integer" />
                </Attributes>
            </Dimension>
            <Dimension source="CountryIncomeStatus" />
            <Dimension source="SecondaryCountryIncomeStatus" />
            
            <Dimension table="YesNoTable" name="UN Development Assistance Framework" caption="Is there an UN Development Assistance Framework (UNDAF), or equivalent?" />
            
            <Dimension name="Date of Signature" caption="Date of Signature" table='CP3GeneralCube' key="Dimension Id" type="TIME">
                <Attributes>
                    <Attribute name="Dimension Id" keyColumn="ID"
                               hasHierarchy="false"
                               levelType="Regular" datatype="Integer"/>

                    <Attribute name="Date of Signature" caption="Date of Signature" keyColumn="DATE_OF_SIGNATURE"
                               hierarchyHasAll="true"
                               levelType="TimeUndefined" datatype="Date"/>
                </Attributes>
            </Dimension>

            <Dimension name="Start Date" caption="UNDAF Start Date" table='CP3GeneralCube' key="Dimension Id" type="TIME">
                <Attributes>
                    <Attribute name="Dimension Id" keyColumn="ID"
                               hasHierarchy="false"
                               levelType="Regular" datatype="Integer"/>

                    <Attribute name="Start Date" caption="UNDAF Start Date" keyColumn="START_DATE"
                               hierarchyHasAll="true"
                               levelType="TimeYears" datatype="Date"/>
                </Attributes>
            </Dimension>

            <Dimension name="End Date" caption="UNDAF End Date" table='CP3GeneralCube' key="Dimension Id" type="TIME">
                <Attributes>
                    <Attribute name="Dimension Id" keyColumn="ID"
                               hasHierarchy="false"
                               levelType="Regular" datatype="Integer"/>

                    <Attribute name="End Date" caption="UNDAF End Date" keyColumn="END_DATE"
                               hierarchyHasAll="true"
                               levelType="TimeYears" datatype="Date"/>
                </Attributes>
            </Dimension>

            <Dimension table="YesNoTable" name="Is your UNCT in the process of developing a new UNDAF" caption="Is your UNCT in the process of developing a new UNDAF?" />
            <Dimension table="YesNoTable" name="Common Country Assessment (CCA)" caption="Did the UNCT lead their own Common Country Assessment (CCA) conducted for the present UNDAF?" />
            
            <Dimension name="Year CCA was conducted" caption="Year CCA was conducted" table='CP3GeneralCube' key="Dimension Id">
                <Attributes>
                    <Attribute name="Dimension Id" keyColumn="ID"
                               hasHierarchy="false"
                               levelType="Regular" datatype="Integer"/>

                    <Attribute name="Year CCA was conducted" caption="Year CCA was conducted" keyColumn="ASSESSMENT_YEAR"
                               approxRowCount="2" hierarchyHasAll="true"
                               levelType="Regular" datatype="Boolean"/>
                </Attributes>
            </Dimension>
            
            <Dimension source="CATEGORY" table="AlternativeAnalysis" caption="If the UNCT relied on other analysis, which alternative option did you use?" />
            <Dimension table="YesNoTable" name="Is official disaggregated data available" caption="Is official disaggregated data available?" />
            <Dimension table="YesNoTable" name="National Development Plan" caption="Is there a National Development Plan?" />
            <Dimension table="YesNoTable" name="Did the UN support the development of the National Plan" caption="Did the UN support the development of the National Plan?" />
            <Dimension table="YesNoTable" name="Joint Programmes" caption="Do you have Joint Programmes?" />
            <Dimension table="YesNoTable" name="UNDAF Annual Review" caption="Have you conducted an UNDAF Annual Review in the last 12 months?" />
            
            <Dimension name="Date Completed (Annual Review)" caption="Date Completed (Annual Review)" table='CP3GeneralCube' key="Dimension Id" type="TIME">
                <Attributes>
                    <Attribute name="Dimension Id" keyColumn="ID"
                               hasHierarchy="false"
                               levelType="Regular" datatype="Integer"/>

                    <Attribute name="Date Completed (Annual Review)" caption="Date Completed (Annual Review)" keyColumn="HASUNDAFANNUAL_DATE_COMPLETED"
                               hierarchyHasAll="true"
                               levelType="TimeUndefined" datatype="Date"/>
                </Attributes>
            </Dimension>
            
            <Dimension table="YesNoTable" name="UNDAF Evaluation" caption="Have you conducted an UNDAF evaluation for the last UNDAF cycle?" />
            
            <Dimension name="Date completed (NRAs participate in the UNDAF Evaluation Planning)" caption="Date completed (NRAs participate in the UNDAF Evaluation Planning)" table='CP3GeneralCube' key="Dimension Id" type="TIME">
                <Attributes>
                    <Attribute name="Dimension Id" keyColumn="ID"
                               hasHierarchy="false"
                               levelType="Regular" datatype="Integer"/>

                    <Attribute name="Date completed (NRAs participate in the UNDAF Evaluation Planning)" caption="Date completed (NRAs participate in the UNDAF Evaluation Planning)" keyColumn="HASUNDAFEVALUATION_DATE_COMPLETED"
                               hierarchyHasAll="true"
                               levelType="TimeUndefined" datatype="Date"/>
                </Attributes>
            </Dimension>

            <Dimension table="YesNoTable" name="Was a management response prepared" caption="Was a management response prepared?" />
            <Dimension source="CATEGORY" table="YesPartiallyNoNAQuestion" name="NRAUndafAnnualReview" caption="Did NRAs participate in the UNDAF Annual Review?" />
            <Dimension table="YesNoTable" name="Was there an extension of the UNDAF" caption="Was there an extension of the UNDAF (approved by the Regional UNDG)?" />
            <Dimension table="YesNoTable" name="Does the UNDAF include a theory of change" caption="Does the UNDAF include a theory of change?" />
            <Dimension table="YesNoTable" name="Do you have a costed monitoring and evaluation plan for the UNDAF" caption="Do you have a costed monitoring and evaluation plan for the UNDAF?" />
            <Dimension table="YesNoTable" name="Is there a UN Vision 2030 paper" caption="Is there a UN Vision 2030 paper?" />
            
            <Dimension name="Year UNDAF completed" caption="Year UNDAF M&amp;E plan was completed" table='CP3GeneralCube' visible="true">
                <Attributes>
                    <Attribute name="Year" keyColumn="YEAR_COMPLETED" datatype="Integer" />
                </Attributes>
            </Dimension>

            <Dimension name="Year UN Vision 2030 was prepared" caption="Year UN Vision 2030 was prepared" table='CP3GeneralCube' visible="true">
                <Attributes>
                    <Attribute name="Year" keyColumn="YEAR_PREPARED" datatype="Integer" />
                </Attributes>
            </Dimension>
            
            <Dimension table="YesNoTable" name="Did NRA contribute to the UN Vision 2030 paper" caption="Did NRA contribute to the UN Vision 2030 paper?" />
            <Dimension table="YesNoTable" name="Has your UNCT prepared a roadmap for its new UNDAF" caption="Has your UNCT prepared a roadmap for its new UNDAF?" />

            <Dimension name="Date UNDAF Roadmap was developed" caption="Date UNDAF Roadmap was developed" table='CP3GeneralCube' key="Dimension Id" type="TIME">
                <Attributes>
                    <Attribute name="Dimension Id" keyColumn="ID"
                               hasHierarchy="false"
                               levelType="Regular" datatype="Integer"/>

                    <Attribute name="Date UNDAF Roadmap was developed" caption="Date UNDAF Roadmap was developed" keyColumn="NEWUNDAFROADMAP_DATE"
                               hierarchyHasAll="true"
                               levelType="TimeUndefined" datatype="Date"/>
                </Attributes>
            </Dimension>
            
            <Dimension source="CATEGORY" table="UNDAFPeriodAlignedWithGov" caption="Is the period of the UN Development Assistance Framework (or equivalent instrument) aligned with the Government's planning and budgeting cycle?" />

            <Dimension name="National Development Plan Start Date" caption="National Development Plan Start Date" table='CP3GeneralCube' key="Dimension Id" type="TIME">
                <Attributes>
                    <Attribute name="Dimension Id" keyColumn="ID"
                               hasHierarchy="false"
                               levelType="Regular" datatype="Integer"/>

                    <Attribute name="National Development Plan Start Date" caption="National Development Plan Start Date" keyColumn="NATIONAL_DEVELOPMENT_PLAN_START_DATE"
                               hierarchyHasAll="true"
                               levelType="TimeUndefined" datatype="Date"/>
                </Attributes>
            </Dimension>

            <Dimension name="National Development Plan End Date" caption="National Development Plan End Date" table='CP3GeneralCube' key="Dimension Id" type="TIME">
                <Attributes>
                    <Attribute name="Dimension Id" keyColumn="ID"
                               hasHierarchy="false"
                               levelType="Regular" datatype="Integer"/>

                    <Attribute name="National Development Plan End Date" caption="National Development Plan End Date" keyColumn="NATIONAL_DEVELOPMENT_PLAN_END_DATE"
                               hierarchyHasAll="true"
                               levelType="TimeUndefined" datatype="Date"/>
                </Attributes>
            </Dimension>
            
            <Dimension source="CATEGORY" table="DaoSOPsImplementingLevel" name="SdgsAndAgenda2030" caption="Are SDGs and Agenda 2030 mainstreamed in the National Development Plan?" />
            <Dimension source="CATEGORY" table="YesNoNAQuestion" name="NRAParticipatedInNationalDevelopmentPlan" caption="Did NRAs participate in supporting development of the National Development Plan?" />
            <Dimension source="CATEGORY" table="YesPartiallyNoNAQuestion" name="NRAParticipated" caption="Did NRAs participate in the UNDAF Evaluation Planning?" />
            <Dimension source="CATEGORY" table="YesPartiallyNoNAQuestion" name="NRAContributeToEvaluationMgmtResponse" caption="Did NRA contribute to the evaluation management response?" />
        </Dimensions>

        <MeasureGroups>
            <MeasureGroup name="CP3 General Cube Measures" table="CP3GeneralCube">
                <Measures>
                    <Measure name="Count" caption="Number of Country Records Submitted" column="ID" datatype="Integer"
                             aggregator="distinct-count" visible="true" formatString="#,###"/>

                    <Measure name="UNDevelopmentAssistanceFramework" caption="Count UNDAF" column="HASUNDAF_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="totalPlannedBudget" caption="Total Planned Budget of UNDAF" column="TOTAL_PLANNED_BUDGET"
                             datatype="Numeric" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="preparationProcessMonths" caption="How long (in months) was the UNDAF preparation process" column="PREPARATION_PROCESS_MONTHS"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="isDevelopingNewUNDAF" caption="Count of 'Is your UNCT in the process of developing a new UNDAF'" column="IS_DEVELOPING_NEWUNDAF_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="CommonCountryAssessment" caption="Count UNCT lead their own CCA" column="HAS_COMMON_COUNTRY_ASSESSMENT_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="hasDisaggregatedData" caption="Count of 'Is official disaggregated data available'" column="HAS_DISAGGREGATED_DATA_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="NationalDevelopmentPlan" caption="Count is there a National Development Plan" column="HAS_NATIONAL_DEVELOPMENT_PLAN_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="hasUNSupport" caption="Count of 'Did the UN support the development of the National Plan'" column="HASUNSUPPORT_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="JointProgrammes" caption="Count of Joint Programmes" column="HAS_JOINT_PROGRAMMES_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="UNDAFAnnualReview" caption="Count of conducted an UNDAF Annual Review in the last 12 months" column="HASUNDAFANNUAL_REVIEW_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="UNDAFEvaluation" caption="Count of conducted an UNDAF Evaluation within the past five years" column="HASUNDAFEVALUATION_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="managementResponsePrepared" caption="Count of 'Was a management response prepared'" column="MANAGEMENT_RESPONSE_PREPARED_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="undafExtensionPresent" caption="Count of 'Was there an extension of the UNDAF (approved by the Regional UNDG)'" column="UNDAF_EXTENSION_PRESENT_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="theoryOfChangeIncluded" caption="Count of 'Does the UNDAF include a theory of change'" column="THEORY_OF_CHANGE_INCLUDED_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="costedMePlanPresent" caption="Count of 'Do you have a costed monitoring and evaluation plan for the UNDAF'" column="COSTEDMEPLAN_PRESENT_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="unVision2030Present" caption="Count of 'Is there a UN Vision 2030 paper'" column="UN_VISION2030PRESENT_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="nraContributor" caption="Count of 'Did NRA contribute to the UN Vision 2030 paper'" column="NRA_CONTRIBUTOR_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>

                    <Measure name="newUndafRoadmapPrepared" caption="Count of 'Has your UNCT prepared a roadmap for its new UNDAF'" column="NEWUNDAFROADMAP_PREPARED_COUNT"
                             datatype="Integer" aggregator="sum" visible="true" formatString="#,###"/>
                </Measures>
                <DimensionLinks>
                    <!-- ## _SHARED_DIMENSIONS_LINKS_TAG_ ## -->
                    <ForeignKeyLink dimension="UN Development Assistance Framework" foreignKeyColumn="HASUNDAF"/>
                    <ForeignKeyLink dimension="Common Country Assessment (CCA)" foreignKeyColumn="HAS_COMMON_COUNTRY_ASSESSMENT"/>
                    <ForeignKeyLink dimension="National Development Plan" foreignKeyColumn="HAS_NATIONAL_DEVELOPMENT_PLAN"/>
                    <ForeignKeyLink dimension="Joint Programmes" foreignKeyColumn="HAS_JOINT_PROGRAMMES"/>
                    <ForeignKeyLink dimension="UNDAF Annual Review" foreignKeyColumn="HASUNDAFANNUAL_REVIEW"/>
                    <ForeignKeyLink dimension="UNDAF Evaluation"  foreignKeyColumn="HASUNDAFEVALUATION"/>
                    <ForeignKeyLink dimension="Is your UNCT in the process of developing a new UNDAF"  foreignKeyColumn="IS_DEVELOPING_NEWUNDAF"/>
                    <FactLink dimension="Year CCA was conducted" />
                    <ForeignKeyLink dimension="Is official disaggregated data available"  foreignKeyColumn="HAS_DISAGGREGATED_DATA"/>
                    <ForeignKeyLink dimension="Did the UN support the development of the National Plan"  foreignKeyColumn="HASUNSUPPORT"/>
                    <ForeignKeyLink dimension="Was a management response prepared"  foreignKeyColumn="MANAGEMENT_RESPONSE_PREPARED"/>
                    <FactLink dimension="Date of Signature" />
                    <FactLink dimension="Start Date" />
                    <FactLink dimension="End Date" />
                    <FactLink dimension="Date Completed (Annual Review)" />
                    <FactLink dimension="Date completed (NRAs participate in the UNDAF Evaluation Planning)" />
                    <ForeignKeyLink dimension="AlternativeAnalysis"  foreignKeyColumn="OTHER_ANALYSIS_SOURCE_ID"/>
                    <ForeignKeyLink dimension="NRAUndafAnnualReview"  foreignKeyColumn="NRAS_PARTICIPATED_INUNDAFANNUAL_REVIEW_ID"/>
                    <ForeignKeyLink dimension="Was there an extension of the UNDAF"  foreignKeyColumn="UNDAF_EXTENSION_PRESENT"/>
                    <ForeignKeyLink dimension="Does the UNDAF include a theory of change"  foreignKeyColumn="THEORY_OF_CHANGE_INCLUDED"/>
                    <ForeignKeyLink dimension="Do you have a costed monitoring and evaluation plan for the UNDAF"  foreignKeyColumn="COSTEDMEPLAN_PRESENT"/>
                    <ForeignKeyLink dimension="Is there a UN Vision 2030 paper"  foreignKeyColumn="UN_VISION2030PRESENT"/>
                    <FactLink dimension="Year UNDAF completed" />
                    <FactLink dimension="Year UN Vision 2030 was prepared" />
                    <ForeignKeyLink dimension="Did NRA contribute to the UN Vision 2030 paper"  foreignKeyColumn="NRA_CONTRIBUTOR"/>
                    <ForeignKeyLink dimension="Has your UNCT prepared a roadmap for its new UNDAF"  foreignKeyColumn="NEWUNDAFROADMAP_PREPARED"/>
                    <FactLink dimension="Date UNDAF Roadmap was developed" />
                    <ForeignKeyLink dimension="UNDAFPeriodAlignedWithGov"  foreignKeyColumn="UNDAF_PERIOD_ALIGNED_WITH_GOV_ID"/>
                    <FactLink dimension="National Development Plan Start Date" />
                    <FactLink dimension="National Development Plan End Date" />
                    <ForeignKeyLink dimension="SdgsAndAgenda2030"  foreignKeyColumn="SDGS_AND_AGENDA2030IN_NATIONAL_DEVELOPMENT_PLAN_ID"/>
                    <ForeignKeyLink dimension="NRAParticipatedInNationalDevelopmentPlan"  foreignKeyColumn="NRAS_PARTICIPATED_IN_NATIONAL_DEVELOPMENT_PLAN_ID"/>
                    <ForeignKeyLink dimension="NRAParticipated"  foreignKeyColumn="NRA_PARTICIPATED_ID"/>
                    <ForeignKeyLink dimension="NRAContributeToEvaluationMgmtResponse"  foreignKeyColumn="NRA_CONTRIBUTE_TO_EVALUATION_MANAGEMENT_RESPONSE_ID"/>
                </DimensionLinks>
            </MeasureGroup>
        </MeasureGroups>
    </Cube>
</Schema>
