<?xml version="1.0" encoding="UTF-8"?>
<Schema name="CCRS" metamodelVersion="4.0"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="mondrian.xsd">
    <Annotations>
        <Annotation name="desc">Cube Schema for CCRS</Annotation>
    </Annotations>

    <PhysicalSchema>
        <Table name="WORKPLAN">
            <Key>
                <Column name="ID"/>
            </Key>
        </Table>

        <Table name="WORKSTREAM">
            <Key>
                <Column name="ID"/>
            </Key>
        </Table>

        <Link source="WORKPLAN" target="WORKSTREAM">
            <ForeignKey>
                <Column name="WORKPLAN_ID"/>
            </ForeignKey>
        </Link>

    </PhysicalSchema>

    <Cube name="CCRS Analysis" caption="CCRS Analysis" visible="true" cache="true" enabled="true">
        <!-- Define dimensions and attributes -->
        <Dimensions>
            <Dimension name="Workflow" caption="Workflow dimension" table='WORKPLAN' key="Dimension Id" visible="true">
                <Attributes>
                    <!-- by default we also have visible="false" when hasHierarchy="false" -->
                    <Attribute name="Dimension Id"
                               keyColumn="ID"
                               hasHierarchy="false"
                               levelType="Regular"
                               datatype="Integer"/>

                    <Attribute name="Workflow"
                               caption="Workflow caption"
                               keyColumn="WORKFLOW"
                               hierarchyAllMemberName="All workflows"
                               hierarchyCaption="All Workflow hierarchy caption"
                               levelType="Regular"
                               datatype="String"/>
                </Attributes>
            </Dimension>

            <Dimension name="Time" table='WORKPLAN' key="Year Id" type="TIME">
                <Attributes>
                    <!-- by default we also have visible="false" when hasHierarchy="false" -->
                    <Attribute name="Year Id"
                               keyColumn="ID"
                               hasHierarchy="false"
                               levelType="Regular"
                               datatype="Integer"/>

                    <Attribute name="Year"
                               caption="Year caption"
                               keyColumn="ENTITY_YEAR"
                               hierarchyAllMemberName="All Years"
                               hierarchyCaption="Year hierarchy caption"
                               levelType="TimeYears"
                               datatype="Integer"/>
                </Attributes>
            </Dimension>
        </Dimensions>

        <!-- Define Measures -->
        <MeasureGroups>
            <MeasureGroup name="WORKPLAN Measures" table="WORKPLAN">
                <Measures>
                    <Measure name="Count" caption="Number of countries" column="ID" datatype="Integer" aggregator="count" visible="true" formatString="#,###"/>
                </Measures>
                <DimensionLinks>
                    <FactLink dimension="Workflow" />
                    <FactLink dimension="Time" />
                    <!--<ForeignKeyLink dimension="Workplan" foreignKeyColumn="ID"/>-->
                </DimensionLinks>
            </MeasureGroup>
        </MeasureGroups>

    </Cube>
</Schema>

